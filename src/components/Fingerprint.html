<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script> navigator.credentials.create({
        publicKey: {
            // The challenge generated by the server
            challenge: new Uint8Array(serverChallenge),
            rp: {
                name: "Example Website",
            },
            user: {
                id: new Uint8Array(userId), // A unique identifier for the user
                name: "user@example.com",
                displayName: "User Name",
            },
            pubKeyCredParams: [
                {
                    type: "public-key",
                    alg: -7, // ES256 algorithm
                },
            ],
            authenticatorSelection: {
                authenticatorAttachment: "platform", // Use the platform authenticator (e.g., fingerprint scanner)
            },
            timeout: 60000, // Optional timeout
            attestation: "direct", // Can be "none", "indirect", or "direct"
        },
    }).then((credential) => {
        // Send the credential to the server for verification
        fetch('/register', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                id: credential.id,
                rawId: Array.from(new Uint8Array(credential.rawId)),
                type: credential.type,
                response: {
                    attestationObject: Array.from(new Uint8Array(credential.response.attestationObject)),
                    clientDataJSON: Array.from(new Uint8Array(credential.response.clientDataJSON)),
                },
            }),
        });
    }).catch((error) => {
        console.error(error);
    });
    navigator.credentials.get({
    publicKey: {
        challenge: new Uint8Array(serverChallenge),
        allowCredentials: [
            {
                id: new Uint8Array(credentialId), // ID of the previously registered credential
                type: "public-key",
                transports: ["internal"], // Use internal transport (e.g., built-in fingerprint scanner)
            },
        ],
        timeout: 60000, // Optional timeout
    },
}).then((assertion) => {
    // Send the assertion to the server for verification
    fetch('/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
            id: assertion.id,
            rawId: Array.from(new Uint8Array(assertion.rawId)),
            type: assertion.type,
            response: {
                authenticatorData: Array.from(new Uint8Array(assertion.response.authenticatorData)),
                clientDataJSON: Array.from(new Uint8Array(assertion.response.clientDataJSON)),
                signature: Array.from(new Uint8Array(assertion.response.signature)),
                userHandle: Array.from(new Uint8Array(assertion.response.userHandle || new Uint8Array())),
            },
        }),
    });
}).catch((error) => {
    console.error(error);
});</script>
</body>
</html>